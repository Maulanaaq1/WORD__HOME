<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Data Pelanggan - WORD NET</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    tbody tr:nth-child(even) { background-color: #e5e9fd; }
    tbody tr:nth-child(odd) { background-color: #f3f4ff; }
  </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm px-4">
  <a class="navbar-brand fw-bold me-5" href="#">
    <img src="Word.png" alt="Logo" height="30" class="d-inline-block align-text-top">
  </a>
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarContent">
    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
      <li class="nav-item"><a class="nav-link" href="laporan.html"><i class="fas fa-chart-line"></i> Laporan</a></li>
      <li class="nav-item"><a class="nav-link" href="absen.html"><i class="fas fa-user-check"></i> Absen</a></li>
      <li class="nav-item"><a class="nav-link" href="pemasukan.html"><i class="fas fa-wallet"></i> Pemasukan</a></li>
      <li class="nav-item"><a class="nav-link" href="pengeluaran.html"><i class="fas fa-money-bill-wave"></i> Pengeluaran</a></li>
      <li class="nav-item"><a class="nav-link" href="asset.html"><i class="fas fa-box"></i> Assets</a></li>
      <li class="nav-item"><a class="nav-link" href="Instalasi.html"><i class="fas fa-clipboard"></i> Instalasi</a></li>
      <li class="nav-item"><a class="nav-link" href="Approval.html"><i class="fas fa-check-circle"></i> Approval</a></li>
      <li class="nav-item"><a class="nav-link active" href="pelanggan.html"><i class="fas fa-users"></i> Pelanggan</a></li>
    </ul>
    <a class="nav-link text-danger" href="index.html"><i class="fas fa-sign-out-alt"></i> Logout</a>
  </div>
</nav>

<div class="container mt-4">
  <h3 class="text-success mb-3"><i class="fas fa-users"></i> Data Pelanggan</h3>
  
  <!-- Cari -->
  <input type="text" id="searchInput" class="form-control mb-3" placeholder="Cari nama pelanggan...">

  <!-- Tabel Pelanggan -->
  <div class="table-responsive card shadow">
    <table class="table table-bordered mb-0" id="tabelPelanggan">
      <thead style="background-color:#274eec; color:white;">
        <tr>
          <th>Nama</th>
          <th>Email</th>
          <th>Alamat</th>
          <th>No. Telepon</th>
          <th>Paket</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDCougF9lDyP70dCwngEQApRMgk6VPRj90",
    authDomain: "wordhome-9ffd0.firebaseapp.com",
    databaseURL: "https://wordhome-9ffd0-default-rtdb.firebaseio.com",
    projectId: "wordhome-9ffd0",
    storageBucket: "wordhome-9ffd0.firebasestorage.app",
    messagingSenderId: "907251172383",
    appId: "1:907251172383:web:d71150b40f0b274994c12a",
    measurementId: "G-WL5VGK0W4J"
  };
  firebase.initializeApp(firebaseConfig);

  const pelangganDB = firebase.database().ref("pelanggan");
  const tbody = document.querySelector("#tabelPelanggan tbody");
  const searchInput = document.getElementById("searchInput");

  function renderTable(data, filter=""){
    tbody.innerHTML = "";
    for(let id in data){
      const p = data[id];
      if(p.nama && p.nama.toLowerCase().includes(filter.toLowerCase())){
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${p.nama}</td>
          <td>${p.email || "-"}</td>
          <td>${p.alamat || "-"}</td>
          <td>${p.notelpon || "-"}</td>
          <td>${p.paket || "-"}</td>
          <td><button class="btn btn-sm btn-danger" onclick="hapus('${id}')"><i class="fas fa-trash"></i></button></td>
        `;
        tbody.appendChild(tr);
      }
    }
  }

  pelangganDB.on("value", snap => renderTable(snap.val() || {}));
  searchInput.addEventListener("input", e => {
    pelangganDB.once("value").then(snap => renderTable(snap.val() || {}, e.target.value));
  });

  function hapus(id){
    if(confirm("Hapus pelanggan ini?")) pelangganDB.child(id).remove();
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
